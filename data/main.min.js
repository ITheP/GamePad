var refreshInterval,countdown=5;function updateTime(){const el=document.getElementById("currentTime");if(el){let now=new Date,timeString=now.getHours().toString().padStart(2,"0")+":"+now.getMinutes().toString().padStart(2,"0")+":"+now.getSeconds().toString().padStart(2,"0");el.innerText=timeString}}function startAutoRefresh(){IntervalManager.add((()=>{updateTime()}),1e3)}function updateAccessPoints(){fetch("/json/access_points").then((response=>response.json())).then((data=>{const datalist=document.getElementById("ssidList");datalist&&(datalist.innerHTML="",data.accessPoints&&Array.isArray(data.accessPoints)&&data.accessPoints.forEach((ap=>{const option=document.createElement("option");option.value=ap.SSID,datalist.appendChild(option)})))})).catch((error=>console.error("Error fetching access points:",error)))}function updateWiFiStatus(){fetch("/json/wifi_status").then((response=>response.json())).then((data=>{const statusSpan=document.getElementById("wifiStatus");statusSpan&&data.Status&&(statusSpan.textContent=data.Status)})).catch((error=>console.error("Error fetching wifi status:",error)))}function handleWiFiFormSubmit(event){event.preventDefault();const form=document.getElementById("wifiForm"),responseDiv=document.getElementById("formResponse");if(!form||!responseDiv)return;const formData=new FormData(form);fetch("/api/UpdateWifiDetails",{method:"POST",body:formData}).then((response=>response.json())).then((data=>{let message="";message=data.error?'<p style="color: red;"><strong>Error:</strong> '+escapeHtml(data.error)+"</p>":"ok"===data.status?'<p style="color: green;"><strong>Success:</strong> WiFi details saved</p>':'<p style="color: orange;"><strong>Response:</strong> '+escapeHtml(JSON.stringify(data))+"</p>",responseDiv.innerHTML=message})).catch((error=>{responseDiv.innerHTML='<p style="color: red;"><strong>Error:</strong> '+escapeHtml(error.message)+"</p>"}))}function escapeHtml(text){const div=document.createElement("div");return div.textContent=text,div.innerHTML}function startConfigAutoRefresh(){updateAccessPoints(),updateWiFiStatus(),IntervalManager.add((()=>{updateAccessPoints(),updateWiFiStatus()}),1e4);const form=document.getElementById("wifiForm");form&&form.addEventListener("submit",handleWiFiFormSubmit)}function initializePageFunctions(){document.getElementById("wifiForm")?startConfigAutoRefresh():startAutoRefresh()}initializePageFunctions();