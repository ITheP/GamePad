var refreshInterval,countdown=5;const ui={content:document.getElementById("content"),response:document.getElementById("uiResponse"),batteryLevel:document.getElementById("uiBatteryLevel"),batteryVoltage:document.getElementById("uiBatteryVoltage")};function updateTime(){const el=document.getElementById("currentTime");if(el){let now=new Date,timeString=now.getHours().toString().padStart(2,"0")+":"+now.getMinutes().toString().padStart(2,"0")+":"+now.getSeconds().toString().padStart(2,"0");el.innerText=timeString}}function startAutoRefresh(){updateBatteryInformation(),updateTime(),IntervalManager.add((()=>{updateBatteryInformation()}),1e4),IntervalManager.add((()=>{updateTime()}),1e3)}function showResponseError(message="Please check controller is powered on and successfully connected to your WiFi network"){ui.response.innerHTML='<span style="color: red;"><strong>Error</strong> - '+message+"</span>"}function showResponse(message){ui.response.innerHTML='<span style="color: green;">'+message+"</span>"}function clearResponse(){ui.response.innerHTML=""}function setGauge(id,min,max,value,unit,icon,empty){const gauge=document.getElementById(id);if(!gauge)return;const fillElem=gauge.querySelector(".gauge-fill"),valueElem=gauge.querySelector(".gauge-text .value"),unitElem=gauge.querySelector(".gauge-text .unit"),warningElem=gauge.querySelector(".gauge-warning"),range=max-min;let pct=100*Math.max(0,Math.min(1,(value-min)/range));pct<1?pct=1:pct>100&&(pct=100),warningElem.textContent=pct<5?empty:icon,fillElem.style.setProperty("--fill-pct",pct),valueElem.textContent=value.toFixed(1),unitElem.textContent=unit}function updateBatteryInformation(){fetch("/json/battery_info").then((response=>{if(!response.ok)throw new Error(`HTTP ${response.status}: ${response.statusText}`);return response.json()})).then((data=>{ui.batteryLevel&&void 0!==data.BatteryLevel&&(ui.batteryLevel.innerHTML=data.BatteryLevel+"%"),ui.batteryVoltage&&void 0!==data.BatteryVoltage&&(ui.batteryVoltage.value=data.BatteryVoltage+"v");let batteryVoltage=randomisedValue(3.7,4.7,.15),batteryLevel=randomisedValue(0,100,.15);setGauge("gaugeVoltage",3.3,4.2,batteryVoltage,"v","‚ö°","Empty"),setGauge("gaugePercent",0,100,batteryLevel,"%","üîã","Empty")})).catch((error=>{console.error("Error fetching battery information:",error),showResponseError("Unable to get battery information."),setGauge("gaugeVoltage",3.3,4.2,0,"v","‚ö°","‚ùì"),setGauge("gaugePercent",0,100,0,"%","üîã","‚ùì")}))}startAutoRefresh();